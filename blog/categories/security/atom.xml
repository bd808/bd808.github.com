<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: security | bd808.com]]></title>
  <link href="http://bd808.com/blog/categories/security/atom.xml" rel="self"/>
  <link href="http://bd808.com/"/>
  <updated>2013-12-09T23:04:51-07:00</updated>
  <id>http://bd808.com/</id>
  <author>
    <name><![CDATA[Bryan Davis]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[FileVault2 Hacks]]></title>
    <link href="http://bd808.com/blog/2013/12/09/file-vault2-hacks/"/>
    <updated>2013-12-09T21:35:52-07:00</updated>
    <id>http://bd808.com/blog/2013/12/09/file-vault2-hacks</id>
    <content type="html"><![CDATA[<p>Mac OS X 10.7 introduced a whole disk encryption service called
<a href="http://support.apple.com/kb/ht4790">FileVault2</a>. This allows you to use AES 128 encryption to protect your
data. This is a great feature but it has a few small drawbacks. It uses the
password of your primary user account to unlock the system. I&#39;m a fan of
strong passwords but for encryption I&#39;d prefer to use a longer pass phrase for
increased entropy. Second the EFI-boot screen that is used to get the password
to decrypt the disk shows the display name of all usersthat can unlock the
system rather than blank fields for both username and password. This leaks
information that I would really rather not leak. Fortunately I&#39;ve found
a little hack to work around both of these issues.</p>

<!-- more -->

<p>The key to my fix lies in this statement from the documentation:</p>

<blockquote>
<p>Users not enabled for FileVault unlock are only able to log into the
computer after an unlock-enabled user has started or unlocked the drive.
Once unlocked, the drive remains unlocked and available to all users, until
the computer is restarted.
<small><a href="http://support.apple.com/kb/ht4790">&quot;OS X: About FileVault 2&quot;</a></small></p>
</blockquote>

<p>My fix is to create a new local user account that will only be used to unlock
the disk encryption key. This will provide a fix for both issues. Since this
account won&#39;t be my primary account I can give it a much longer password
without risk of <a href="https://en.wikipedia.org/wiki/Repetitive_strain_injury">RSI</a> every time that OS X prompts me for an administrator
password to install or update software. I can also give the user an innocuous
display name to be shown on the unlock screen.</p>

<ol>
<li>Create a new account from the <em>Users &amp; Groups</em> control panel:

<ul>
<li>New Account: Standard</li>
<li>Full Name: ************</li>
<li>Account name: encrypt</li>
<li>Password: omg this is a really long passphrase for me to remember</li>
</ul></li>
<li>Follow the <a href="http://support.apple.com/kb/ht4790">instructions</a> for enabling FileVault 2 and chose the new
user as the only user who can unlock the disk.</li>
</ol>

<p>If you already have FileVault 2 enabled you will need to remove the decryption
right from the existing users. The easiest way I&#39;ve found to do this is using
the <code>fdesetup</code> command line tool. <code>sudo fdesetup list</code> will show you the
accounts that are enabled. <code>sudo fdesetup remove -user bd808</code> will remove the
certificate for the <em>bd808</em> user.</p>

<p>One last step is to make the new <em>encrypt</em> user log out as soon as they log
in. This will return control to the normal OS X login system where you can
configure the login screen to display username and password prompts instead of
a list of local user accounts. There are probably several ways to do this, but
I chose to make a small application that executes this apple script command:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>logout </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ignoring application responses
</span><span class='line'>  tell application &quot;loginwindow&quot; to «event aevtlogo»
</span><span class='line'>end ignoring</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
</feed>
